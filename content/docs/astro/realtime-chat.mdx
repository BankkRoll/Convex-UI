---
title: Realtime Chat
description: Real-time chat component for collaborative Astro applications
---

<DualRealtimeChat />

## Installation

<BlockItem
  name="realtime-chat-astro"
  description="Renders a real-time chat interface for users in a shared room."
/>

## Folder structure

<RegistryBlock itemName="realtime-chat-astro" />

## Introduction

The Realtime Chat component provides a complete chat interface that enables users to exchange messages in real-time. Built on Convex's real-time subscriptions, messages sync instantly across all connected clients without any polling or manual refresh.

## Usage

Since the Realtime Chat component requires interactivity, use the `client:load` directive in Astro:

<CodeBlock language="astro">
{`---
// src/pages/chat.astro
import Layout from "@/layouts/Layout.astro";
import ChatRoom from "@/components/ChatRoom";
---

<Layout title="Chat">
  <ChatRoom client:load />
</Layout>`}
</CodeBlock>

### Basic usage

Create a React component that includes the chat:

<CodeBlock language="tsx">
{`// src/components/ChatRoom.tsx
import { RealtimeChat } from "@/components/realtime-chat";

export default function ChatRoom() {
  return <RealtimeChat roomName="my-chat-room" username="john_doe" />;
}`}
</CodeBlock>

### How it works

The chat component uses Convex's real-time queries to automatically sync messages:

<CodeBlock language="tsx">
{`import { useQuery, useMutation } from "convex/react";
import { api } from "@/convex/_generated/api";

// Messages automatically update when new ones are added
const messages = useQuery(api.messages.list, { roomName: "my-chat-room" });

// Send a new message
const sendMessage = useMutation(api.messages.send);
await sendMessage({
roomName: "my-chat-room",
content: "Hello!",
username: "john_doe",
});`}

</CodeBlock>

### Backend functions

The component expects these Convex functions:

<CodeBlock language="ts">
{`// convex/messages.ts
import { query, mutation } from "./_generated/server";
import { v } from "convex/values";

export const list = query({
  args: { roomName: v.string() },
  handler: async (ctx, args) => {
    return await ctx.db
      .query("messages")
      .withIndex("by_room", (q) => q.eq("roomName", args.roomName))
      .order("asc")
      .collect();
  },
});

export const send = mutation({
  args: {
    roomName: v.string(),
    content: v.string(),
    username: v.string(),
  },
  handler: async (ctx, args) => {
    await ctx.db.insert("messages", {
      roomName: args.roomName,
      content: args.content,
      username: args.username,
      createdAt: Date.now(),
    });
  },
});`}
</CodeBlock>

## Features

- Real-time message synchronization (no polling needed)
- Automatic updates when data changes
- Customizable message appearance
- Automatic scroll-to-bottom on new messages
- Room-based isolation for scoped conversations
- Connection status indicator

## Props

| Prop       | Type     | Description                                                 |
| ---------- | -------- | ----------------------------------------------------------- |
| `roomName` | `string` | Unique identifier for the shared chat room.                 |
| `username` | `string` | Name of the current user; used to identify message senders. |

### ChatMessage type

<CodeBlock language="tsx">
  {`interface ChatMessage {
  id: string;
  content: string;
  user: {
    name: string;
  };
  createdAt: string;
}`}
</CodeBlock>

## Astro Integration Notes

When using the Realtime Chat component in Astro:

- Always use `client:load` directive since the component needs real-time message synchronization
- Ensure the Convex provider is set up at a higher level in your component tree
- The component handles all the real-time subscription logic internally

<CodeBlock language="astro">
{`---
import { ConvexAuthProvider } from "@/lib/convex/provider";
import { RealtimeChat } from "@/components/realtime-chat";
---

<div class="max-w-2xl mx-auto p-4">
  <ConvexAuthProvider client:load>
    <RealtimeChat
      client:load
      roomName="general"
      username="guest-user"
    />
  </ConvexAuthProvider>
</div>`}
</CodeBlock>

### Multiple chat rooms

You can easily create multiple chat rooms in your Astro application:

<CodeBlock language="astro">
{`---
// src/pages/chat/[room].astro
import Layout from "@/layouts/Layout.astro";
import ChatRoom from "@/components/ChatRoom";

export function getStaticPaths() {
  return [
    { params: { room: "general" } },
    { params: { room: "random" } },
    { params: { room: "announcements" } },
  ];
}

## const { room } = Astro.params;

<Layout title={"Chat - " + room}>
  <ChatRoom client:load roomName={room} />
</Layout>`}
</CodeBlock>

## Further reading

- [Convex Real-time Queries](https://docs.convex.dev/client/react/queries)
- [Convex Mutations](https://docs.convex.dev/client/react/mutations)
- [Building a Chat App with Convex](https://docs.convex.dev/tutorial)
- [Astro React Integration](https://docs.astro.build/en/guides/integrations-guide/react/)
