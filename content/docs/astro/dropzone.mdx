---
title: Dropzone (File Upload)
description: Displays a control for easier uploading of files directly to Convex Storage
---

<ComponentPreview
  name="dropzone-demo"
  description="An alert with an icon, title and description. The title says 'Heads up!' and the description is 'You can add components to your app using the cli.'."
  showCode={false}
/>

## Installation

<BlockItem
  name="dropzone-astro"
  description="Displays a control for easier uploading of files directly to Convex Storage"
/>

## Folder structure

<RegistryBlock itemName="dropzone-astro" />

## Introduction

Uploading files should be easyâ€”this component handles the tricky parts for you.

The File Upload component makes it easy to add file uploads to your app, with built-in support for drag-and-drop, file type restrictions, image previews, and configurable limits on file size and number of files. All the essentials, ready to go.

**Features**

- Drag-and-drop support
- Multiple file uploads
- File size and count limits
- Image previews for supported file types
- MIME type restrictions
- Invalid file handling
- Success and error states with clear feedback
- Automatic upload to Convex Storage

## Usage

Since the Dropzone component requires interactivity, it must be rendered as a React island with the `client:load` directive in your Astro pages:

<CodeBlock language="astro">
{`---
// src/pages/upload.astro
import Layout from "@/layouts/Layout.astro";
import FileUploadDemo from "@/components/FileUploadDemo";
---

<Layout title="Upload Files">
  <FileUploadDemo client:load />
</Layout>`}
</CodeBlock>

Create a React component that wraps the Dropzone:

<CodeBlock language="tsx">
{`// src/components/FileUploadDemo.tsx
import {
  Dropzone,
  DropzoneContent,
  DropzoneEmptyState,
} from "@/components/dropzone";
import { useConvexUpload } from "@/hooks/use-convex-upload";

const FileUploadDemo = () => {
const props = useConvexUpload({
allowedMimeTypes: ["image/*"],
maxFiles: 2,
maxFileSize: 1000 _ 1000 _ 10, // 10MB,
});

return (

<div className="w-[500px]">
  <Dropzone {...props}>
    <DropzoneEmptyState />
    <DropzoneContent />
  </Dropzone>
</div>
); };

export { FileUploadDemo };
export default FileUploadDemo;`}
</CodeBlock>

## How it works

The upload process uses Convex's file storage system:

1. **Generate upload URL**: The hook calls a Convex mutation to generate a secure upload URL
2. **Upload file**: The file is uploaded directly to Convex Storage using the generated URL
3. **Save metadata**: After upload, file metadata (storage ID, name, size, type) is saved to your Convex database

<CodeBlock language="ts">
{`// Example Convex functions for file upload
// convex/files.ts

import { mutation } from "./_generated/server";
import { v } from "convex/values";

export const generateUploadUrl = mutation(async (ctx) => {
  return await ctx.storage.generateUploadUrl();
});

export const saveFile = mutation({
  args: {
    storageId: v.id("_storage"),
    name: v.string(),
    size: v.number(),
    type: v.string(),
  },
  handler: async (ctx, args) => {
    return await ctx.db.insert("files", args);
  },
});`}
</CodeBlock>

## Props

| Prop               | Type       | Default | Description                        |
| ------------------ | ---------- | ------- | ---------------------------------- |
| `allowedMimeTypes` | `string[]` | `[]`    | The MIME types to allow for upload |
| `maxFiles`         | `number`   | `1`     | Maximum number of files to upload  |
| `maxFileSize`      | `number`   | `1000`  | Maximum file size in bytes         |

## Astro Integration Notes

When using the Dropzone component in Astro:

- Always use `client:load` directive to ensure the component is interactive
- The component needs to be wrapped in a React component that includes the Convex provider
- Make sure your Astro project has the React integration installed (`@astrojs/react`)

<CodeBlock language="bash">{`npx astro add react`}</CodeBlock>

## Further reading

- [Convex File Storage](https://docs.convex.dev/file-storage)
- [Uploading Files](https://docs.convex.dev/file-storage/upload-files)
- [Serving Files](https://docs.convex.dev/file-storage/serve-files)
- [Astro React Integration](https://docs.astro.build/en/guides/integrations-guide/react/)
