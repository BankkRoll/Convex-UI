---
title: Current User Avatar
description: Convex Auth-aware avatar component for Astro
---

<ComponentPreview name="current-user-avatar-demo" showCode={false} />

## Installation

<BlockItem
  name="current-user-avatar-astro"
  description="Renders the avatar of the current user."
/>

## Folder structure

<RegistryBlock itemName="current-user-avatar-astro" />

## Introduction

The `CurrentUserAvatar` component connects to Convex Auth to fetch the current user's data and display an avatar. It queries the user's profile information and shows their profile image if available. If the user doesn't have a profile image, it renders their initials. If the user is logged out, it renders a `?` as a fallback, which you can customize.

## Usage

The `CurrentUserAvatar` component is designed to be used anywhere in your app. Since it requires interactivity and real-time data from Convex, use the `client:load` directive in Astro:

<CodeBlock language="astro">
{`---
// src/components/Header.astro
import { CurrentUserAvatar } from "@/components/current-user-avatar";
---

<header class="flex items-center justify-between p-4">
  <h1>Lumon Industries</h1>
  <CurrentUserAvatar client:load />
</header>`}
</CodeBlock>

Alternatively, create a React component that includes the avatar:

<CodeBlock language="tsx">
{`// src/components/AppHeader.tsx
import { CurrentUserAvatar } from "@/components/current-user-avatar";

const AppHeader = () => {
return (

<header className="flex items-center justify-between">
  <h1>Lumon Industries</h1>
  <CurrentUserAvatar />
</header>
); };

export default AppHeader;`}
</CodeBlock>

Then use it in your Astro page:

<CodeBlock language="astro">
{`---
import Layout from "@/layouts/Layout.astro";
import AppHeader from "@/components/AppHeader";
---

<Layout title="Dashboard">
  <AppHeader client:load />
</Layout>`}
</CodeBlock>

## How it works

The component uses Convex queries to fetch the current user's information:

<CodeBlock language="tsx">
{`import { useQuery } from "convex/react";
import { api } from "@/convex/_generated/api";

// Fetch current user data
const user = useQuery(api.users.current);
const name = user?.name ?? null;
const image = user?.image ?? null;`}

</CodeBlock>

This requires a `users.current` query in your Convex backend:

<CodeBlock language="ts">
{`// convex/users.ts
import { query } from "./_generated/server";
import { getAuthUserId } from "@convex-dev/auth/server";

export const current = query({
  args: {},
  handler: async (ctx) => {
    const userId = await getAuthUserId(ctx);
    if (!userId) return null;
    return await ctx.db.get(userId);
  },
});`}
</CodeBlock>

## Props

| Prop   | Type                   | Default | Description        |
| ------ | ---------------------- | ------- | ------------------ |
| `size` | `"sm" \| "md" \| "lg"` | `"md"`  | Size of the avatar |

If you wish to change the fallback behavior, you can modify the `CurrentUserAvatar` component directly.

## Astro Integration Notes

When using the CurrentUserAvatar component in Astro:

- Always use `client:load` directive since the component needs to fetch user data from Convex
- Ensure the Convex provider is set up at a higher level in your component tree
- The component will show the fallback state (`?`) until the user data is loaded

<CodeBlock language="astro">
{`---
import { ConvexAuthProvider } from "@/lib/convex/provider";
import { CurrentUserAvatar } from "@/components/current-user-avatar";
---

<ConvexAuthProvider client:load>
  <nav class="flex items-center gap-4">
    <a href="/">Home</a>
    <CurrentUserAvatar client:load size="sm" />
  </nav>
</ConvexAuthProvider>`}
</CodeBlock>

## Further reading

- [Convex Auth Documentation](https://docs.convex.dev/auth)
- [Getting the Current User](https://labs.convex.dev/auth/api_reference/server#getauthuserId)
- [Astro React Integration](https://docs.astro.build/en/guides/integrations-guide/react/)
